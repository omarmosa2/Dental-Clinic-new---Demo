# ๐ง ุงูุฅุตูุงุญ ุงูููุงุฆู: ุฏุนู ูุณุงุฑุงุช ุงููุฌูุฏุงุช

## โ ุงููุดููุฉ ุงูููุชุดูุฉ

```
Error: EISDIR: illegal operation on a directory, read
```

**ุงูุณุจุจ:** ุงููุธุงู ูุงู ูุญุงูู ูุฑุงุกุฉ ูุฌูุฏ ูููู ุตูุฑุฉ ูุฃู ุงููุณุงุฑ ุงููุญููุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุชูู ุจู `/` (ูุฌูุฏ) ููู ุฏุงูุฉ `getDentalImage` ูุงูุช ุชุญุงูู ูุฑุงุกุชู ูููู.

## โ ุงูุฅุตูุงุญ ุงููุทุจู

ุชู ุชุญุฏูุซ ุฏุงูุชูู ูู `electron/main.js`:

### 1. ุฏุงูุฉ `files:getDentalImage`
```javascript
// ูุจู ุงูุฅุตูุงุญ - ูุงูุช ุชุญุงูู ูุฑุงุกุฉ ุงููุฌูุฏ ูููู
const imageBuffer = fs.readFileSync(fullPath) // ุฎุทุฃ ุฅุฐุง ูุงู fullPath ูุฌูุฏ

// ุจุนุฏ ุงูุฅุตูุงุญ - ุชุชุญูู ูู ููุน ุงููุณุงุฑ ุฃููุงู
if (imagePath.endsWith('/')) {
  // ุงูุจุญุซ ุนู ุตูุฑ ูู ุงููุฌูุฏ
  const files = fs.readdirSync(searchPath)
  const imageFiles = files.filter(file => {
    const ext = path.extname(file).toLowerCase()
    return ['.jpg', '.jpeg', '.png', '.gif', '.bmp', '.webp'].includes(ext)
  })
  
  if (imageFiles.length > 0) {
    // ุฅุฑุฌุงุน ุฃุญุฏุซ ุตูุฑุฉ
    const imageFile = imageFiles.sort().reverse()[0]
    return loadImage(path.join(searchPath, imageFile))
  }
}
```

### 2. ุฏุงูุฉ `files:checkImageExists`
```javascript
// ูุจู ุงูุฅุตูุงุญ - ูุญุต ูุฌูุฏ ุงูููู ูุจุงุดุฑุฉ
if (fs.existsSync(userDataPath)) {
  return true
}

// ุจุนุฏ ุงูุฅุตูุงุญ - ูุญุต ุงููุฌูุฏ ูุงูุจุญุซ ุนู ุตูุฑ
if (imagePath.endsWith('/')) {
  const files = fs.readdirSync(searchPath)
  const imageFiles = files.filter(file => {
    const ext = path.extname(file).toLowerCase()
    return ['.jpg', '.jpeg', '.png', '.gif', '.bmp', '.webp'].includes(ext)
  })
  
  return imageFiles.length > 0
}
```

## ๐ฏ ููู ูุนูู ุงููุธุงู ุงูุขู

### ุนูุฏ ุฑูุน ุตูุฑุฉ:
```javascript
// 1. ุฅูุดุงุก ุงููุฌูุฏ
dental_images/47d9cebe-5f88-4f3a-9c91-7c504c6c245e/11/before/

// 2. ุญูุธ ุงูุตูุฑุฉ
dental_images/47d9cebe-5f88-4f3a-9c91-7c504c6c245e/11/before/image-1750601234567.png

// 3. ุญูุธ ุงููุณุงุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุจุฏูู ุงุณู ุงูููู)
dental_images/47d9cebe-5f88-4f3a-9c91-7c504c6c245e/11/before/
```

### ุนูุฏ ุนุฑุถ ุงูุตูุฑุฉ:
```javascript
// 1. ุงููุธุงู ูุชููู ุงููุณุงุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
imagePath = "dental_images/47d9cebe-5f88-4f3a-9c91-7c504c6c245e/11/before/"

// 2. ูุชุญูู ุฃู ุงููุณุงุฑ ููุชูู ุจู "/"
if (imagePath.endsWith('/')) {

// 3. ูุจุญุซ ุนู ุตูุฑ ูู ุงููุฌูุฏ
const searchPath = "/path/to/dental_images/47d9cebe-5f88-4f3a-9c91-7c504c6c245e/11/before/"
const files = fs.readdirSync(searchPath)

// 4. ูููุชุฑ ุงูุตูุฑ ููุท
const imageFiles = ["image-1750601234567.png", "image-1750601234568.png"]

// 5. ูุฎุชุงุฑ ุฃุญุฏุซ ุตูุฑุฉ
const latestImage = "image-1750601234568.png"

// 6. ูุญูู ุงูุตูุฑุฉ ููุนุฑุถูุง
return loadImage("/path/to/dental_images/.../image-1750601234568.png")
```

## ๐ ุงูููุงุฆุฏ ุงููุญููุฉ

### โ ุญู ูุดููุฉ ุงูุฎุทุฃ
- ูุง ูุฒูุฏ ูู ุฎุทุฃ `EISDIR: illegal operation on a directory`
- ุงููุธุงู ูุชุนุงูู ุจุฐูุงุก ูุน ุงููุณุงุฑุงุช ุงููุฎุชููุฉ

### โ ูุฑููุฉ ูู ุฅุฏุงุฑุฉ ุงูุตูุฑ
- ูููู ุญูุธ ุนุฏุฉ ุตูุฑ ูู ููุณ ุงููุฌูุฏ
- ุงููุธุงู ูุฎุชุงุฑ ุฃุญุฏุซ ุตูุฑุฉ ุชููุงุฆูุงู
- ุณูููุฉ ูู ุฅุถุงูุฉ ุฃู ุญุฐู ุงูุตูุฑ

### โ ุชูุงูู ูุน ุงููุธุงู ุงููุฏูู
- ูุฏุนู ุงููุณุงุฑุงุช ุงููุฏููุฉ (ูุน ุงุณู ุงูููู)
- ูุฏุนู ุงููุณุงุฑุงุช ุงูุฌุฏูุฏุฉ (ูุฌูุฏ ููุท)
- ุงูุชูุงู ุณูุณ ุจุฏูู ููุฏุงู ุจูุงูุงุช

## ๐ ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1: ูุณุงุฑ ุฌุฏูุฏ (ูุฌูุฏ)
```
ูุงุนุฏุฉ ุงูุจูุงูุงุช: dental_images/47d9cebe-5f88-4f3a-9c91-7c504c6c245e/11/before/
ุงููุธุงู ูุจุญุซ ูู: /userData/dental_images/47d9cebe-5f88-4f3a-9c91-7c504c6c245e/11/before/
ูุฌุฏ: image-1750601234567.png, image-1750601234568.png
ูุนุฑุถ: ุฃุญุฏุซ ุตูุฑุฉ (image-1750601234568.png)
```

### ูุซุงู 2: ูุณุงุฑ ูุฏูู (ููู ูุงูู)
```
ูุงุนุฏุฉ ุงูุจูุงูุงุช: dental_images/ุนูุฑุฑ/before/tooth11-before.png
ุงููุธุงู ูุจุญุซ ุนู: /userData/dental_images/ุนูุฑุฑ/before/tooth11-before.png
ูุฌุฏ: ุงูููู ูุจุงุดุฑุฉ
ูุนุฑุถ: tooth11-before.png
```

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

ุงูุขู ุงููุธุงู:

1. โ **ูุญูุธ ุงูุตูุฑ** ูู `dental_images/{patient_id}/{tooth_number}/{image_type}/`
2. โ **ูุญูุธ ุงููุณุงุฑ** ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุฏูู ุงุณู ุงูููู
3. โ **ูุนุฑุถ ุงูุตูุฑ** ุจุงูุจุญุซ ูู ุงููุฌูุฏ ุงููุญุฏุฏ
4. โ **ูุฏุนู ุนุฏุฉ ุตูุฑ** ูู ููุณ ุงููุฌูุฏ
5. โ **ูุฎุชุงุฑ ุฃุญุฏุซ ุตูุฑุฉ** ุชููุงุฆูุงู
6. โ **ูุฏุนู ุงููุธุงู ุงููุฏูู** ููุชูุงูู

๐ **ุงููุดููุฉ ูุญูููุฉ ุจุงููุงูู!**

## ๐ง ุฎุทูุงุช ุงูุชุญูู

1. **ุฃุนุฏ ุชุดุบูู ุงูุชุทุจูู** ูุชุญููู ุงูููุฏ ุงููุญุฏุซ
2. **ุงุฑูุน ุตูุฑุฉ ุฌุฏูุฏุฉ** ูุณู ูุนูู
3. **ุชุญูู ูู ุนุฑุถ ุงูุตูุฑุฉ** - ูุฌุจ ุฃู ุชุธูุฑ ุจุฏูู ุฃุฎุทุงุก
4. **ุชุญูู ูู ุงููุฌูุฏ** - ูุฌุจ ุฃู ุชุฌุฏ ุงููููู ุงูุฌุฏูุฏ
5. **ุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช** - ูุฌุจ ุฃู ุชุฌุฏ ุงููุณุงุฑ ููุชูู ุจู `/`
